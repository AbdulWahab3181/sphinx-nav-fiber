import{r as a,j as t,A as O,y as I,bh as C,f as T,h as y,T as F,F as x,a3 as z,B as N}from"./index-a077ec8a.js";import{B as P}from"./index-a3fc54ec.js";import{u as w}from"./index-c7fa7ded.js";import{e as M,F as R,C as v,B as k}from"./react-toastify.esm-2e85d31b.js";import{A}from"./index-2f16c94b.js";import{a as D}from"./constants-cde8ebc3.js";import{A as H}from"./index-7b659b8b.js";import"./Popover-ebfb4a66.js";import"./useSlotProps-05454b58.js";import"./Select-c9bbc705.js";import"./Stack-4435e687.js";import"./Popper-befd2ef6.js";const U=({selectedType:r,setSelectedType:d})=>{const[c,o]=a.useState([]);a.useEffect(()=>{(async()=>{try{const{data:p}=await O();o(p.edge_types)}catch(p){console.warn(p)}})()},[o]);const i=n=>({label:n,value:n}),f=n=>{d((n==null?void 0:n.value)||"")};return t.jsx(A,{onSelect:f,options:c.map(i),selectedValue:r?i(r):null})},V=({onSelect:r,selectedValue:d})=>{const[c,o]=a.useState([]),[i,f]=a.useState(!1),n=async e=>{const g={muted:"False",sort_by:H,search:e,skip:"0",limit:"1000"};f(!0);try{const m=await C(g.search);o(m.data)}catch{o([])}finally{f(!1)}},p=a.useMemo(()=>I.debounce(n,300),[]),s=e=>{if(!e){o([]);return}e.length>2&&p(e)},j=e=>{const g=e?c.find(m=>m.ref_id===e.value):null;r(g||null)},l=e=>({label:e.search_value,value:e.ref_id,type:e.node_type}),S=e=>e.map(l);return t.jsx(A,{handleInputChange:s,isLoading:i,onSelect:j,options:S(c)||D,selectedValue:d?l(d):null})},Y=({from:r,onSelect:d,selectedType:c,setSelectedType:o,selectedToNode:i})=>t.jsxs(x,{mb:20,children:[t.jsx(x,{align:"center",direction:"row",justify:"space-between",mb:18,children:t.jsx(x,{align:"center",direction:"row",children:t.jsx($,{children:"Add edge"})})}),t.jsxs(G,{mb:12,children:[t.jsxs(E,{children:[t.jsx("div",{className:"label",children:"From"}),t.jsx("div",{children:r})]}),t.jsxs(E,{children:[t.jsx("div",{className:"label",children:"Type"}),t.jsx(U,{selectedType:c,setSelectedType:o})]}),t.jsxs(E,{children:[t.jsx("div",{className:"label",children:"To"}),t.jsx(V,{onSelect:d,selectedValue:i})]})]})]}),$=T(F)`
  font-size: 22px;
  font-weight: 600;
  font-family: 'Barlow';
`,G=T(x).attrs({align:"stretch",direction:"column",justify:"flex-start"})`
  color: ${y.white};
  .label {
    margin-bottom: 8px;
    font-weight: 500;
    font-size: 14px;
    color: ${y.GRAY3};
  }
`,E=T(x)`
  flex: 1 1 100%;
  min-height: unset;
  margin-bottom: 8px;
`,W=()=>{var b;const{close:r}=w("addEdgeToNode"),d=M({mode:"onChange"}),[c,o]=a.useState(!1),[i,f]=a.useState(""),[n,p]=a.useState(!1),[s,j]=a.useState(null);console.log(1234);const[l,S]=a.useState(),e=z();a.useEffect(()=>{(async()=>{if(e){p(!0);try{if(e.type==="topic"){const{data:u}=await C(e==null?void 0:e.name,{exact_match:"true",node_type:"topic"}),_=u.find(B=>B.node_type==="topic");S(_)}}catch(u){console.log(u)}finally{p(!1)}}})()},[e]);const g=()=>{r()},m=async()=>{const h=l||e;if(!(!s||!(h!=null&&h.ref_id))){o(!0);try{await N({from:h.ref_id,to:s==null?void 0:s.ref_id,relationship:i});const{ref_id:u}=h,{ref_id:_}=s;console.log(u,_),g()}catch(u){console.warn(u)}finally{o(!1)}}},L=c||!s||!i;return t.jsxs(R,{...d,children:[n?t.jsx(x,{align:"center",my:24,children:t.jsx(v,{color:y.BLUE_PRESS_STATE,size:24})}):t.jsx(Y,{from:l?l==null?void 0:l.search_value:(e==null?void 0:e.name)||"",onSelect:j,selectedToNode:s,selectedType:i,setSelectedType:f}),t.jsxs("div",{children:[(b=l||e)==null?void 0:b.ref_id,": ",s==null?void 0:s.ref_id]}),t.jsxs(k,{color:"secondary",disabled:L,onClick:m,size:"large",variant:"contained",children:["Confirm",c&&t.jsx(v,{color:y.BLUE_PRESS_STATE,size:10})]})]})},re=()=>{const{close:r}=w("addEdgeToNode");return t.jsx(P,{id:"addEdgeToNode",kind:"large",onClose:r,preventOutsideClose:!0,children:t.jsx(W,{})})};export{re as AddNodeEdgeModal};
