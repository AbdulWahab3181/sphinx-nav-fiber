import{r as n,j as s,a5 as B,Y as T,a0 as y,Z as D,X as h,aX as I}from"./index-8faf46a6.js";import{cz as N,cA as C,cB as z,u as w,cj as R,az as F,cl as P,cb as b,bP as k,cC as M,cc as U}from"./index-71ade4e6.js";import{n as v}from"./toastMessage-46a0771a.js";import{A,O as Y}from"./constants-ff2b72c1.js";import"./index-85c9dbf0.js";import"./Select-a9fd3043.js";const G=({selectedType:a,setSelectedType:d})=>{const[l,t]=n.useState([]);n.useEffect(()=>{(async()=>{try{const{data:u}=await N();t(u.edge_types)}catch(u){console.warn(u)}})()},[t]);const c=o=>({label:o,value:o}),p=o=>{d((o==null?void 0:o.value)||"")};return s.jsx(A,{onSelect:p,options:l.map(c),selectedValue:a?c(a):null})},H=({onSelect:a,selectedValue:d})=>{const[l,t]=n.useState([]),[c,p]=n.useState(!1),o=async e=>{const m={muted:"False",sort_by:z,search:e,skip:"0",limit:"1000"};p(!0);try{const f=await C(m.search);t(f.data)}catch{t([])}finally{p(!1)}},u=n.useMemo(()=>B.debounce(o,300),[]),r=e=>{if(!e){t([]);return}e.length>2&&u(e)},S=e=>{const m=e?l.find(f=>f.ref_id===e.value):null;a(m||null)},i=e=>({label:e.search_value,value:e.ref_id,type:e.node_type}),j=e=>e.map(i);return s.jsx(A,{handleInputChange:r,isLoading:c,onSelect:S,options:j(l)||Y,selectedValue:d?i(d):null})},V=({from:a,onSelect:d,selectedType:l,setSelectedType:t,selectedToNode:c})=>s.jsxs(h,{mb:20,children:[s.jsx(h,{align:"center",direction:"row",justify:"space-between",mb:18,children:s.jsx(h,{align:"center",direction:"row",children:s.jsx(X,{children:"Add edge"})})}),s.jsxs($,{mb:12,children:[s.jsxs(_,{children:[s.jsx("div",{className:"label",children:"From"}),s.jsx("div",{children:a})]}),s.jsxs(_,{children:[s.jsx("div",{className:"label",children:"Type"}),s.jsx(G,{selectedType:l,setSelectedType:t})]}),s.jsxs(_,{children:[s.jsx("div",{className:"label",children:"To"}),s.jsx(H,{onSelect:d,selectedValue:c})]})]})]}),X=T(D)`
  font-size: 22px;
  font-weight: 600;
  font-family: 'Barlow';
`,$=T(h).attrs({align:"stretch",direction:"column",justify:"flex-start"})`
  color: ${y.white};
  .label {
    margin-bottom: 8px;
    font-weight: 500;
    font-size: 14px;
    color: ${y.GRAY3};
  }
`,_=T(h)`
  flex: 1 1 100%;
  min-height: unset;
  margin-bottom: 8px;
`,W="Link sucessfully created!",Z=()=>{const{close:a}=w("addEdgeToNode"),d=R({mode:"onChange"}),[l,t]=n.useState(!1),[c,p]=n.useState(""),[o,u]=n.useState(!1),[r,S]=n.useState(null),[i,j]=n.useState(),e=F();n.useEffect(()=>{(async()=>{if(e){u(!0);try{if(e.type==="topic"){const{data:g}=await C(e==null?void 0:e.name,{exact_match:"true",node_type:"topic"}),E=g.find(O=>O.node_type==="topic");j(E)}}catch(g){console.log(g)}finally{u(!1)}}})()},[e]);const m=()=>{a()},f=async()=>{if(!(!r||!i)){t(!0);try{const x=i||r;await M({from:x.ref_id,to:r==null?void 0:r.ref_id,relationship:c});const{ref_id:g}=x,{ref_id:E}=r;console.log(g,E),v(W,"success"),m()}catch(x){console.warn(x),v(I)}finally{t(!1)}}},L=l||!r||!c;return s.jsxs(P,{...d,children:[o?s.jsx(h,{align:"center",my:24,children:s.jsx(b,{color:y.BLUE_PRESS_STATE,size:24})}):s.jsx(V,{from:i?i==null?void 0:i.search_value:(e==null?void 0:e.name)||"",onSelect:S,selectedToNode:r,selectedType:c,setSelectedType:p}),s.jsxs(k,{color:"secondary",disabled:L,onClick:f,size:"large",variant:"contained",children:["Confirm",l&&s.jsx(b,{color:y.BLUE_PRESS_STATE,size:10})]})]})},te=()=>{const{close:a}=w("addEdgeToNode");return s.jsx(U,{id:"addEdgeToNode",kind:"large",onClose:a,preventOutsideClose:!0,children:s.jsx(Z,{})})};export{te as AddNodeEdgeModal};
